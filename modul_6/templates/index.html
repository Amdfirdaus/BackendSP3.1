<!DOCTYPE html>
<html lang="id">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Bootstrap CSS -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.rtl.min.css"
      integrity="sha384-CfCrinSRH2IR6a4e6fy2q6ioOX7O6Mtm1L9vRvFZ1trBncWmMePhzvafv7oIcWiW"
      crossorigin="anonymous"
    />

    <title>Data Barang Bangunan</title>
  </head>
  <body class="bg-light">
    <div class="container mb-4">
      <h2 class="text-center mb-3">Data Barang Bangunan</h2>

      <div class="text-end mb-3">
        <a href="{{url_for('add_barang')}}" class="btn btn-primary">
          + Barang</a
        >
      </div>
      {% with messages = get_flashed_messages(with_categories=true) %} {% if
      messages %} {% for category, message in messages %}
      <div
        class="alert alert-{{ category }} alert-dismissible fade show"
        role="alert"
      >
        {{ message }}
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="alert"
        ></button>
      </div>
      {% endfor %} {% endif %} {% endwith %}

      <form method="get" action="{{ url_for('index') }}" class="d-flex mb-3">
        <input
          type="text"
          name="search"
          class="form-control me-2"
          placeholder="Cari berdasarkan kode atau nama barang..."
          value="{{ search_query }}"
        />
        <button type="submit" class="btn btn-primary">Cari</button>
      </form>

      <table
        class="table table-bordered table-striped align-middle text-center"
      >
        <thead class="table-dark">
          <tr>
            <th>Kode</th>
            <th>Nama Barang</th>
            <th>Satuan</th>
            <th>Stok</th>
            <th>Harga</th>
            <th>Gambar</th>
            <th>Aksi</th>
          </tr>
        </thead>
        <tbody>
          {% for b in barang %}
          <tr>
            <td>{{ b[1] }}</td>
            <td>{{ b[2] }}</td>
            <td>{{ b[3] }}</td>
            <td>{{ b[4] }}</td>
            <td>Rp {{ "{:,.0f}".format(b[5]) }}</td>
            <td>
              {% if b[6] %}
              <img
                src="{{ url_for('uploaded_file', filename=b[6]) }}"
                width="80"
              />
              {% else %}
              <span class="text-muted">Tidak ada</span>
              {% endif %}
            </td>
            <td>
              <a
                href="{{ url_for('edit_barang', id=b[0]) }}"
                class="btn btn-warning btn-sm"
                >Edit</a
              >
              <a
                href="{{ url_for('delete_barang', id=b[0]) }}"
                class="btn btn-danger btn-sm"
                onclick="return confirm('Yakin ingin menghapus barang ini?')"
                >Hapus</a
              >
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>

      <nav>
        <ul class="pagination justify-content-center">
          {% for p in range(1, total_pages + 1) %}
          <li class="page-item {% if p == page %}active{% endif %}">
            <a
              class="page-link"
              href="?page={{ p }}{% if search_query %}&search={{ search_query }}{% endif %}"
            >
              {{ p }}
            </a>
          </li>
          {% endfor %}
        </ul>
      </nav>
    </div>

    <!-- Optional JavaScript; choose one of the two! -->

    <!-- Option 1: Bootstrap Bundle with Popper -->
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI"
      crossorigin="anonymous"
    ></script>

    <!-- Option 2: Separate Popper and Bootstrap JS -->
    <!--
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.min.js" integrity="sha384-G/EV+4j2dNv+tEPo3++6LCgdCROaejBqfUeNjuKAiuXbjrxilcCdDz6ZAVfHWe1Y" crossorigin="anonymous"></script>
    -->
  </body>
</html>
